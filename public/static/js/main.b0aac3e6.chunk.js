(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{30:function(e,t,a){e.exports=a(80)},37:function(e,t,a){},39:function(e,t,a){},41:function(e,t,a){},48:function(e,t,a){},69:function(e,t,a){},71:function(e,t,a){},73:function(e,t,a){},75:function(e,t,a){},77:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a.n(i),c=a(26),s=a.n(c),o=(a(37),a(3)),r=a(4),l=a(6),u=a(5),d=a(7),p=a(82),h=a(84),y=a(83),m=a(81),f=(a(39),a(9)),v=(a(41),a(12)),g=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).handleGoHistory=e.handleGoHistory.bind(Object(f.a)(Object(f.a)(e))),e}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{id:"musicHeader"},this.props.isMusicBack&&n.a.createElement("a",{onTouchStart:this.handleGoHistory},"<"),this.props.musicName)}},{key:"componentDidMount",value:function(){}},{key:"handleGoHistory",value:function(){window.history.go(-1)}}]),t}(i.Component);var O=Object(v.b)(function(e){return{isMusicBack:e.isMusicBack,musicName:e.musicName,isMusicPlay:e.isMusicPlay}},function(e){return{}})(g),M=(a(48),a(13)),b=a.n(M);function N(e){return window.sessionStorage.getItem(e)}var E=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).handlePlayBtn=e.handlePlayBtn.bind(Object(f.a)(Object(f.a)(e))),e}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{id:"musicAudio"},n.a.createElement("div",{className:"audioPlay",ref:"audioPlay",onTouchStart:this.handlePlayBtn}),n.a.createElement("div",{className:"audioProgress",ref:"audioProgress"},n.a.createElement("div",{className:"audioBar",ref:"audioBar"}),n.a.createElement("div",{className:"audioNow",ref:"audioNow"})),n.a.createElement("audio",{ref:"audio",src:this.props.musicId&&this.props.songUrl,id:"audio"}))}},{key:"componentDidMount",value:function(){this.musicBarDrag()}},{key:"componentDidUpdate",value:function(){"pic"===this.props.pathName&&(this.props.isMusicPlay?this.playMusic():this.pauseMusic())}},{key:"playMusic",value:function(){this.refs.audioPlay.style.backgroundImage="url(/images/list_audioPause.png)",this.refs.audio.play(),this.playingRun(),this.props.handleMusicOver(-1),this.timers=setInterval(this.playingRun.bind(this),1e3),clearInterval(this.timer)}},{key:"pauseMusic",value:function(){this.refs.audioPlay.style.backgroundImage="url(/images/list_audioPlay.png)",this.refs.audio.pause(),clearInterval(this.timers)}},{key:"handlePlayBtn",value:function(){var e=document.getElementsByClassName("small")[0];""!==this.refs.audio.getAttribute("src")&&(this.refs.audio.paused?(this.playMusic(),this.props.handleMusicPlay(!0),"pic"===this.props.pathName&&(e.style.animationPlayState="running")):("pic"===this.props.pathName&&(e.style.animationPlayState="paused"),this.pauseMusic(),this.props.handleMusicPlay(!1)))}},{key:"playingRun",value:function(){var e=this.refs.audioNow,t=this.refs.audio,a=this.refs.audioBar,i=t.currentTime/t.duration;if(a.style.left=i*a.parentNode.offsetWidth-7+"px",e.style.width=100*i+"%",1===i){this.props.handleMusicPlay(!1),this.pauseMusic(),this.props.handleLocalLyric(""),e.style.width="0%",a.style.left="-7px","lyric"===this.props.pathName&&(document.getElementById("lyricUl").style.top="0px");for(var n=JSON.parse(N("songList")),c=0;c<n.length;c++)if(n[c].mid===this.props.musicId)return this.props.handleNextSong(n[c+1]),this.props.handleSongUrl(n[c+1].url),this.refs.audio.setAttribute("src",this.props.nextSong.url),this.props.handleMusicId(this.props.nextSong.mid),this.props.handleMusicName(this.props.nextSong.title),this.refs.audio.paused?(console.log(1),this.props.handleMusicPlay(!0),void this.playMusic()):void 0}}},{key:"musicBarDrag",value:function(){var e=this.refs.audioNow,t=this.refs.audio;this.refs.audioBar.ontouchstart=function(a){var i,n=this,c=a.changedTouches[0];return i=c.pageX-this.offsetLeft,document.ontouchmove=function(a){var c=a.changedTouches[0].pageX-i;c<-7?c=-7:c>n.parentNode.offsetWidth-7&&(c=n.parentNode.offsetWidth-7),n.style.left=c+"px";try{var s=(c+7)/n.parentNode.offsetWidth;e.style.width=(100*s).toFixed(2)+"%",t.currentTime=s*t.duration}catch(o){console.log(o)}},document.ontouchend=function(){document.ontouchmove=document.ontouchend=null},!1}}}]),t}(i.Component);var I=Object(v.b)(function(e){return{musicId:e.musicId,isMusicPlay:e.isMusicPlay,pathName:e.pathName,overTime:e.overTime,nextSong:e.nextSong,songUrl:e.songUrl}},function(e){return{handleMusicPlay:function(t){e({type:"IS_MUSIC_PLAY",payload:t})},handleMusicOver:function(t){e({type:"OVER_TIME",payload:t})},handleNextSong:function(t){e({type:"NEXT_SONG",payload:t})},handleMusicId:function(t){e({type:"MUSIC_ID",payload:t})},handleMusicName:function(t){e({type:"MUSIC_NAME",payload:t})},handleLocalLyric:function(t){e({type:"LOCAL_LYRIC",payload:t})},handleSongUrl:function(t){e({type:"SONG_URL",payload:t})}}})(E),S=(a(69),a(71),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"loader"})}}]),t}(i.Component)),j=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).handleMove=e.handleMove.bind(Object(f.a)(Object(f.a)(e))),e.handleEnd=e.handleEnd.bind(Object(f.a)(Object(f.a)(e))),e.state={list:[11111,222222],isLoading:!1},e}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{id:"musicList"},this.state.isLoading?n.a.createElement("ul",null,this.state.list.map(function(t,a){return n.a.createElement("li",{className:e.props.musicId===t.mid?"active":"",key:t.mid},n.a.createElement("div",{onTouchMove:e.handleMove,onTouchEnd:function(){return e.handleEnd(t.mid)}},n.a.createElement("div",{className:"listOrder"},a+1),n.a.createElement("div",{className:"listName"},n.a.createElement("h3",null,t.title),n.a.createElement("p",null,t.author))))})):n.a.createElement(S,null))}},{key:"componentDidMount",value:function(){var e=this;this.props.location.pathname.replace(/[^\/]+/,function(t){e.props.handlePathName(t)}),this.props.handleBack(!1);var t=N("songList");t?this.setState({list:JSON.parse(t),isLoading:!0}):b.a.get("/music/api/?key=523077333&id=3641614987&type=songlist&cache=1&size=hq").then(function(t){var a,i;"OK"===t.data.Code&&(a="songList",i=JSON.stringify(t.data.Body),window.sessionStorage.setItem(a,i),e.setState({list:t.data.Body,isLoading:!0}))})}},{key:"handleMove",value:function(){this.isMove=!0}},{key:"handleEnd",value:function(e){if(this.isMove)this.isMove=!1;else{this.props.history.push("pic/"+e),this.props.handleBack(!0),this.props.handleMusicId(e),this.props.handleNusicPlay(!0);var t=this.state.list.filter(function(t){if(t.mid===e)return t});this.props.handleMusicName(t[0].title),this.props.handleSongUrl(t[0].url)}}}]),t}(i.Component);var L=Object(v.b)(function(e){return{musicData:e.allMusicData,musicId:e.musicId}},function(e){return{handleBack:function(t){e({type:"IS_MUSIC_BACK",payload:t})},handleMusicId:function(t){e({type:"MUSIC_ID",payload:t})},handleNusicPlay:function(t){e({type:"IS_MUSIC_PLAY",payload:t})},handleMusicName:function(t){e({type:"MUSIC_NAME",payload:t})},handlePathName:function(t){e({type:"PATH_NAME",payload:t})},handleSongUrl:function(t){e({type:"SONG_URL",payload:t})}}})(j),k=(a(73),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={isActive:-1,js:0,xi:-1,pervMid:""},e}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{id:"musicLyric"},n.a.createElement("ul",{ref:"lyricUl",id:"lyricUl"},this.props.localLyric&&this.props.localLyric.map(function(t,a){return n.a.createElement("li",{id:"lyli",className:e.state.isActive===a?"active":"",key:a},t.lyric)})))}},{key:"componentDidMount",value:function(){var e=this;this.props.location.pathname.replace(/[^\/]+/,function(t){e.props.handlePathName(t)}),this.props.handleBack(!0);var t=this.props.musicId;b.a.get("/music/api/?key=523077333&cache=1&type=lrc&id="+t).then(function(t){e.props.handleLocalLyric(e.formatLyric(t.data)),e.props.isMusicPlay?e.playLyric():e.pauseLyric()})}},{key:"componentDidUpdate",value:function(){this.handleNoIt(this.props.musicId)}},{key:"componentWillUnmount",value:function(){this.pauseLyric(this.props.musicId)}},{key:"formatLyric",value:function(e){var t=this,a=[];return e.replace(/\[([^\]]+)\]([^\[]+)/g,function(e,i,n){a.push({time:t.formatTimeToSec(i),lyric:n})}),a}},{key:"formatTimeToSec",value:function(e){var t=e.split(":");return(parseFloat(60*t[0])+parseFloat(t[1])).toFixed(2)}},{key:"playLyric",value:function(){this.props.handleMusicOver(-1),this.lyricRuning(),this.timer=setInterval(this.lyricRuning.bind(this),500)}},{key:"pauseLyric",value:function(){clearInterval(this.timer)}},{key:"handleNoIt",value:function(e){var t=this;e!==this.state.pervMid&&(b.a.get("/music/api/?key=523077333&cache=1&type=lrc&id="+e).then(function(e){t.props.handleLocalLyric(t.formatLyric(e.data)),t.props.isMusicPlay?t.playLyric():t.pauseLyric()}),this.setState({pervMid:e}))}},{key:"lyricRuning",value:function(){try{for(var e=this.props.localLyric,t=document.getElementById("audio"),a=this.refs.lyricUl,i=(a.children.length,0);i<e.length;i++)if(t.currentTime>e[i].time&&t.currentTime<e[i+1].time&&(this.setState({isActive:i}),this.state.xi!=i)){for(var n=0,c=0;c<=i;c++)n+=a.children[c].offsetHeight;if(a.style.top=-n+"px",e.length-2===i){var s=this;setTimeout(function(){s.pauseLyric(),s.setState({isActive:e.length-1})},500)}}}catch(o){}}}]),t}(i.Component));var _=Object(v.b)(function(e){return{isMusicPlay:e.isMusicPlay,musicId:e.musicId,localLyric:e.localLyric,pathName:e.pathName}},function(e){return{handleBack:function(t){e({type:"IS_MUSIC_BACK",payload:t})},handlePathName:function(t){e({type:"PATH_NAME",payload:t})},handleMusicOver:function(t){e({type:"OVER_TIME",payload:t})},handleLocalLyric:function(t){e({type:"LOCAL_LYRIC",payload:t})}}})(k),P=(a(75),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).handleGoLyric=e.handleGoLyric.bind(Object(f.a)(Object(f.a)(e))),e}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{id:"pic"},n.a.createElement("div",{className:"big"},n.a.createElement("div",{className:"small",ref:"small"},n.a.createElement("div",{className:"circle"},n.a.createElement("img",{src:"https://api.mlwei.com/music/api/?key=523077333&cache=1&type=pic&id="+this.props.musicId,alt:""})))),n.a.createElement("div",{className:"lyric",onTouchStart:this.handleGoLyric},"\u8bcd"))}},{key:"componentDidMount",value:function(){var e=this;this.props.location.pathname.replace(/[^\/]+/,function(t){e.props.handlePathName(t)}),this.props.handleBack(!0)}},{key:"handleGoLyric",value:function(){var e=this.props.match.params.mid;this.props.history.push("/lyric/"+e)}}]),t}(i.Component));var C=Object(v.b)(function(e){return{isMusicPlay:e.isMusicPlay,musicId:e.musicId}},function(e){return{handleBack:function(t){e({type:"IS_MUSIC_BACK",payload:t})},handlePathName:function(t){e({type:"PATH_NAME",payload:t})}}})(P),U=(a(77),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={list:[]},e}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"container"},this.state.list.map(function(e,t){return n.a.createElement("div",{className:"circle-container",key:t},n.a.createElement("div",{className:"circle"}))}))}},{key:"componentDidMount",value:function(){for(var e=[],t=0;t<100;t++)e.push(t);this.setState({list:e})}}]),t}(i.Component)),T=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return n.a.createElement(p.a,null,n.a.createElement("div",{className:"App"},n.a.createElement(O,null),n.a.createElement(U,null),n.a.createElement(h.a,null,n.a.createElement(y.a,{path:"/list",component:L}),n.a.createElement(y.a,{path:"/pic/:mid",component:C}),n.a.createElement(y.a,{path:"/lyric/:mid",component:_}),n.a.createElement(m.a,{from:"*",to:"/list"})),n.a.createElement(I,null)))}}]),t}(i.Component),B=a(15);var A=Object(B.b)({isMusicBack:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"IS_MUSIC_BACK"===t.type?t.payload:e},musicId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return"MUSIC_ID"===t.type?t.payload:e},isMusicPlay:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"IS_MUSIC_PLAY"===t.type?t.payload:e},musicName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u5dc5\u5cf0\u699c \xb7 \u70ed\u6b4c",t=arguments.length>1?arguments[1]:void 0;return"MUSIC_NAME"===t.type?t.payload:e},pathName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return"PATH_NAME"===t.type?t.payload:e},ovarTime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1?arguments[1]:void 0;return"OVER_TIME"===t.type?t.payload:e},nextSong:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return"NEXT_SONG"===t.type?t.payload:e},localLyric:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return"LOCAL_LYRIC"===t.type?t.payload:e},songUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return"SONG_URL"===t.type?t.payload:e}}),w=Object(B.c)(A,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());s.a.render(n.a.createElement(v.a,{store:w},n.a.createElement(T,null)),document.getElementById("root"))}},[[30,2,1]]]);
//# sourceMappingURL=main.b0aac3e6.chunk.js.map